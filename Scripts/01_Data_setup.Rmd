---
title: "01_Data_Setup"
author: "Calen P. Ryan"
date: "6/30/2021"
output: html_document
---

We have data in dozens of files across decades of time. We need the data in the format we can work with. I'll start bringing things together. A key aspect to this analysis is that it has to be **scaleable**, in that we will later expand the sample size and need to make it as easy as possible to do so without massive changes to the code. 



# Load packages
```{r}
library(tidyverse) # great collection of packages for data carpentry, modelling, and visualization
library(readr)
library(haven) # package for loading Stata's .dta files. 
library(sjlabelled) # good for renaming, changing classes, etc. in the piped dplyr mode
library(zscorer)
library(lubridate)
library(anthro)
library(childsds)
library(sjlabelled)
here::here()
# sets a placeholder 'here'. Then we refer to our files based on the *relative* not the *absolute* location.
```

# Load maternal/child data, birthdays, and early growth parameters

# Load and inspect 83-86
```{r}
mbirth2 <-read_dta(here::here("Data/zip_mother_1983_86/mbirth2.dta")) %>% # note: here::here calls the here function
  rename_all(tolower)

mlong <-read_dta(here::here("Data/zip_mother_1983_86/mlong.dta")) %>% # note: here::here calls the here function
  rename_all(tolower)

dim(mbirth2)
dim(mlong)
```
```{r}
names(mbirth2)

```
```{r}
names (mlong)
```


Find the variables that relate to growth in this dataset
```{r, cache=TRUE}
#subset mbirth data 
#unite identifier variables
growth83_86_birthdata<-mbirth2 %>% 
  select(basebrgy,hhldnubi, basewman, sexchild, outcome, daybirth, mnthbrth, yearbirt, dayintw, mothintw, yearintw, bbweight, weight1, weightak, weightgm, heightcm ) %>% 
  unite(basebrgy, basewman, sep = "_", col = "basebrgy_basewman")

#Create variables for birthday and age at first weigh
 growth83_86_birthdata <- growth83_86_birthdata %>%  
  mutate(weightak_kg = (weightak/1900)) %>% 
  mutate(birthdate = make_date(yearbirt + 1900, mnthbrth, daybirth)) %>% 
  mutate(intwdate = make_date(yearintw +1900, mothintw, dayintw)) %>% 
  mutate(age_days_birthweigh = as.numeric(intwdate - birthdate)) %>%
  filter(outcome != "2" | outcome !="3" ) %>% 
  filter(age_days_birthweigh < 30) %>% 
  filter(age_days_birthweigh > 0) %>% 
  filter(weightak > 0) %>% 
  filter(heightcm > 0) 

#zscores for birth data and rename wfaz/hfaz
 
growth83_86_birthdata <- addWGSR(data = growth83_86_birthdata, sex = "sexchild", firstPart= "weightak_kg", secondPart = "age_days_birthweigh", index = "wfa")

growth83_86_birthdata <- addWGSR(data = growth83_86_birthdata, sex = "sexchild", firstPart = "heightcm", secondPart = "age_days_birthweigh", index = "hfa")

growth83_86_birthdata <- growth83_86_birthdata %>% 
  rename( wfaz_birth = wfaz, hfaz_birth = hfaz)

```

```{r, cache=TRUE}
#subset mlong data and add date of interview
mlong_anthro <-mlong %>% 
  select(basebrgy, basewman,weight, height, yearms, mntham, daymes) %>% 
  mutate(date_inf_meas = lubridate::make_date(year = yearms+1900,
                                              month = mntham,
                                              day = daymes)) %>% 
  arrange(desc(basewman, basebrgy, date_inf_meas)) %>% 
  unite(basebrgy, basewman, sep = "_", col = "basebrgy_basewman")

#make a subset for birthday data
birthdates_data <- growth83_86_birthdata %>% 
  select(basebrgy_basewman, sexchild, birthdate) 
  
#join birthdata and mlong to calculate ages
#unite identifier variables

mlong_anthro_bday <- left_join(birthdates_data, mlong_anthro, by = c("basebrgy_basewman"))
 
mlong_anthro_bday <- mlong_anthro_bday %>% 
   mutate(age_days_infweigh = as.numeric(date_inf_meas - birthdate)) %>% 
   mutate(weight_kg = (weight/1000))

# make the mlong data into wide form, creade new id variables for weight and height 1/12 to reflect first and last infancy measurements

weight_mlong_bday <-mlong_anthro_bday %>%
  select(basebrgy_basewman, sexchild, weight_kg, yearms, mntham, daymes, date_inf_meas, age_days_infweigh, birthdate) %>%
  group_by(basebrgy_basewman) %>%
  mutate(id = row_number()) %>%
  filter(id == max(id)) %>%
  arrange(basebrgy_basewman, id) %>% 
  spread(key = id, value = weight_kg, drop = TRUE) %>% 
  rename(wght_12 = "12" )


height_mlong_bday <-mlong_anthro_bday %>%
  select(basebrgy_basewman, sexchild, height, date_inf_meas, age_days_infweigh, birthdate) %>%
  group_by(basebrgy_basewman) %>%
  mutate(id = row_number()) %>%
  filter(id == max(id)) %>%
  arrange(basebrgy_basewman, id) %>% 
  spread(key = id, value = height, drop = TRUE) %>% 
  rename(hght_12 = "12" )

weight_mlong_bday
height_mlong_bday


```


```{r, cache=TRUE}

#weight zscores infancy
weight_mlong_bday_12 <- weight_mlong_bday %>% 
  select(basebrgy_basewman, sexchild, yearms, mntham, daymes, date_inf_meas, age_days_infweigh, birthdate, "wght_12")

weight_mlong_bday_12 <- addWGSR(data = weight_mlong_bday_12, sex = "sexchild", firstPart= "wght_12", secondPart = "age_days_infweigh", index = "wfa") %>% 
  rename( wfaz_inf_12 = wfaz)

#height z scores infancy

height_mlong_bday_12 <- height_mlong_bday %>% 
  select(basebrgy_basewman, sexchild, date_inf_meas, age_days_infweigh, birthdate, "hght_12")

height_mlong_bday_12 <- addWGSR(data = height_mlong_bday_12, sex = "sexchild", firstPart= "hght_12", secondPart = "age_days_infweigh", index = "hfa") %>% 
  rename( hfaz_inf_12 = hfaz)


```

```{r, cache=TRUE}
#join wfa and hfa zscores in one table

growth83_86_infdata <-left_join(height_mlong_bday_12, weight_mlong_bday_12, by = c("basebrgy_basewman","sexchild","age_days_infweigh", "date_inf_meas", "birthdate"))

growth83_86_infdata

```


```{r}
#make one big 83/86 table with z scores

growth83_86_data <- left_join(growth83_86_birthdata, growth83_86_infdata, by = c("basebrgy_basewman", "sexchild", "birthdate"))

growth83_86_data
```

```{r}
#model weight distributions 
ggplot(growth83_86_data, aes(x = weight1))+
  geom_histogram(color = "white")+
  facet_wrap(~sexchild)

ggplot(growth83_86_data, aes(x = weightak))+
  geom_histogram(color = "white")+
  facet_wrap(~sexchild)

ggplot(growth83_86_data, aes(x = weightgm))+
  geom_histogram(color = "white")+
  facet_wrap(~sexchild)

#model height distributions  
ggplot(growth83_86_data, aes(x=heightcm))+
  geom_histogram(color = "white")+
  facet_wrap(~sexchild)

#summary stats of weight and height
summary_weight83_86 <- growth83_86_data %>%
  group_by(sexchild) %>% 
  drop_na() %>%
  summarize(mean_weight83_86 = mean(weightak),
            std_dev_weight83_86 = sd(weightak),
            med_weight83_86 = median(weightak),
            count = n(), .groups = "keep")

summary_height83_86 <- growth83_86_data %>%
  group_by(sexchild) %>% 
  drop_na() %>%
  summarize(mean_height83_86 = mean(heightcm),
            std_dev_height83_86 = sd(heightcm),
            med_height83_86 = median(heightcm),
            count = n(), .groups = "keep")

summary_weight83_86
summary_height83_86 
```


#Load and inspect 91 data
```{r}
child2 <-read_dta(here::here("Data/zip_child_91/child291.dta")) %>% # note: here::here calls the here function
  rename_all(tolower)

hhold91 <-read_dta(here::here("Data/zip_household_91/hhold91.dta")) %>% # note: here::here calls the here function
  rename_all(tolower)


dim(child2)
dim(hhold91)
```

```{r}
#subset child2 data
#unite identifier variables

growth2 <-child2 %>%
  select(basebrgy, basewman, basehhno, currbrgy, weghtndx, hightndx) %>% 
  unite(basebrgy, basewman, sep = "_", col = "basebrgy_basewman")

#subset hh91 data
#unite identifier variables
intw_date91 <- hhold91 %>% 
  select(basebrgy, basewman, mointr91, dyintrvw, yrintr91) %>% 
  unite(basebrgy, basewman, sep = "_", col = "basebrgy_basewman")

#join tables together to make growth91_data
growth91_data <- left_join(growth2, intw_date91, by = c("basebrgy_basewman"))
         
growth91_data <- left_join(growth91_data, birthdates_data, by = c("basebrgy_basewman"))

growth91_data
```

```{r, cache=TRUE}
#make interview dates and find age at interview
growth91_data<- growth91_data %>% 
  mutate(intwdate91 = make_date( yrintr91+1900, mointr91, dyintrvw)) %>% 
  mutate(age91_days = as.numeric(intwdate91 - birthdate)) %>% 
  mutate(age91_years = as.numeric(intwdate91 - birthdate)/365.25) %>% 
  mutate(age_mo_91 = age91_years*12) %>% 
  filter(age91_days > 0) %>% 
  filter(weghtndx > 0) %>% 
  filter(hightndx > 0)

#calculate zscores for 91 data and rename hfaz/wfaz

growth91_data <- addWGSR(data = growth91_data, sex = "sexchild", firstPart= "weghtndx", secondPart = "age91_days", index = "wfa")

growth91_data <- addWGSR(data = growth91_data, sex = "sexchild", firstPart = "hightndx", secondPart = "age91_days", index = "hfa")

growth91_data <- growth91_data %>% 
  rename( wfaz_91 = wfaz, hfaz_91 = hfaz)


growth91_data

```
```{r}
#model height and weight distributions
ggplot(growth91_data, aes(x= weghtndx))+
  geom_histogram(color = "white")+
  facet_wrap(~sexchild)

ggplot(growth91_data, aes(x=hightndx))+
  geom_histogram(color = "white")+
  facet_wrap(~sexchild)

summary_weight91 <- growth91_data %>%
  group_by(sexchild) %>% 
  drop_na() %>%
  summarize(mean_weight91 = mean(weghtndx),
            std_dev_weight91 = sd(weghtndx),
            med_weight91 = median(weghtndx),
            count = n(), .groups = "keep")

#height and weight summary stats
summary_height91 <- growth91_data %>%
  group_by(sexchild) %>% 
  drop_na() %>%
  summarize(mean_height91 = mean(hightndx),
            std_dev_height91 = sd(hightndx),
            med_height91 = median(hightndx),
            count = n(), .groups = "keep")

summary_weight91
summary_height91
```

#Load and inspect 2002 data

```{r}

anthdiet <-read_dta(here::here("Data/zip_child_2002/anthdiet.dta")) %>% # note: here::here calls the here function
  rename_all(tolower)

screen_data<-read_dta(here::here("Data/zip_child_2002/screen.dta")) %>% # note: here::here calls the here function
  rename_all(tolower)

#subset anthdiet
#calculate bmi
#join identifier variable
anthdiet <- anthdiet %>% 
  select(basebrgy, basewman, weight, height) %>% 
  filter(weight > 0) %>% 
  filter(height > 0) %>% 
  unite(basebrgy, basewman, sep = "_", col = "basebrgy_basewman") %>% 
  rename(weight_02 = weight, height_02 = height)

#subset screen_data
#join identifier variable
screen_data <- screen_data %>% 
  select(basebrgy, basewman, dayntrvw, yrntrvw, montrvw) %>% 
  mutate(intw_date02 = make_date(yrntrvw, montrvw, dayntrvw)) %>% 
  unite(basebrgy, basewman, sep = "_", col = "basebrgy_basewman")
 
#make interview date and find age at interview
screen_data <- left_join(birthdates_data, screen_data, by = c("basebrgy_basewman")) %>% 
  mutate(age_days_02 = as.numeric(intw_date02 - birthdate)) %>% 
  mutate(age_years_02 = age_days_02/365.25) %>% 
  mutate(age_cutoff = if_else(age_years_02 > 19, 19, age_years_02)) %>% 
  mutate(age_cutoff_days = age_cutoff*365.25) %>% 
  filter(age_days_02 > 0)
  
  

growth02_data <- left_join(screen_data, anthdiet, by = c("basebrgy_basewman"))

growth02_data <- addWGSR(data = growth02_data, sex = "sexchild", firstPart= "height_02", secondPart = "age_cutoff_days", index = "hfa") %>% 
   rename(hfaz_02 = hfaz)


growth02_data


```


```{r, cache = TRUE}
#visualize hieght distribution
ggplot(growth02_data, aes(x=height_02))+
  geom_histogram(color = "white")+
  facet_wrap(~sexchild)

#visualize weight distribution 
ggplot(growth02_data, aes(x=weight_02))+
  geom_histogram(color = "white")+
  facet_wrap(~sexchild)

#summarize height 
summary_height_02 <- growth02_data %>%
  group_by(sexchild) %>% 
  drop_na() %>%
  summarize(mean_height02 = mean(height_02),
            std_dev_height02 = sd(height_02),
            med_height02 = median(height_02),
            max_height02 = max(height_02),
            min_height02 = min(height_02),
            count = n(), .groups = "keep")
summary_height_02

#summarize weight
summary_weight_02 <- growth02_data %>%
  group_by(sexchild) %>% 
  drop_na() %>%
  summarize(mean_weight02 = mean(weight_02),
            std_dev_height02 = sd(height_02),
            med_weight02 = median(weight_02),
            max_weight02 = max(weight_02),
            min_weight02 = min(weight_02),
            count = n(), .groups = "keep")

summary_weight_02
```

#2005 data
```{r, chache=TRUE}
#load anthdiet 05
anthdiet05 <-read_dta(here::here("Data/zip_child_2005/anthdiet.dta")) %>% # note: here::here calls the here function
  rename_all(tolower)

#subsetand  unite id variable
#calculate bmi
anthdiet05 <- anthdiet05 %>% 
  select(basebrgy, basewman, age, sex, weight, height) %>% 
  unite(basebrgy, basewman, sep = "_", col = "basebrgy_basewman") %>% 
  rename(weight_05 = weight, height_05 = height)
  
growth05_data <- left_join(birthdates_data, anthdiet05, by = c("basebrgy_basewman")) %>% 
  mutate(height_m_05 = (height_05/100)) %>% 
  mutate( bmi_05 = (weight_05/(height_m_05^2))) %>% 
  filter(weight_05 > 0) %>% 
  filter(height_05 > 0)

growth05_data

#summarize height 
summary_height_05 <- growth05_data %>%
  group_by(sexchild) %>% 
  drop_na() %>%
  summarize(mean_height05 = mean(height_05),
            std_dev_height05 = sd(height_05),
            med_height05 = median(height_05),
            max_height05 = max(height_05),
            min_height05 = min(height_05),
            count = n(), .groups = "keep")
summary_height_05

#summarize weight
summary_weight_05 <- growth05_data %>%
  group_by(sexchild) %>% 
  drop_na() %>%
  summarize(mean_weight05 = mean(weight_05),
            std_dev_height05 = sd(height_05),
            med_weight05 = median(weight_05),
            max_weight05 = max(weight_05),
            min_weight05 = min(weight_05),
            count = n(), .groups = "keep")

summary_weight_05
 
#summarize bmi
summary_bmi_05 <- growth05_data %>%
  group_by(sexchild) %>% 
  drop_na() %>%
  summarize(mean_bmi = mean(bmi_05),
            std_dev_bmi = sd(bmi_05),
            med_bmi = median(bmi_05),
            max_bmi = max(bmi_05),
            min_bmi = min(bmi_05),
            count = n(), .groups = "keep")

summary_bmi_05


```



#zscore analysis

```{r, cache=TRUE }
#table of zscores :)
zscore_data <- left_join(growth83_86_data, growth91_data, by = c("basebrgy_basewman", "sexchild")) 
zscore_data <- left_join(zscore_data, growth02_data, by = c("basebrgy_basewman", "sexchild"))

zscore_wfa<- zscore_data %>% 
  select(basebrgy_basewman, sexchild, age_days_birthweigh, age_days_infweigh, age91_days, wfaz_birth, wfaz_inf_12, wfaz_91)

zscore_hfa <-zscore_data %>% 
  select(basebrgy_basewman, sexchild, age_days_birthweigh, age_days_infweigh, age91_days, hfaz_birth, hfaz_inf_12, hfaz_91, hfaz_02) 
  

zscore_hfa
zscore_wfa

```

#Hfaz differences 
```{r, cache = TRUE}
#make a table for birth and 2 yrs old data
#find the difference between these

hfa_diff1 <- zscore_hfa %>% 
  select(basebrgy_basewman, sexchild, hfaz_birth, hfaz_inf_12) %>%
  mutate(hfa_diff_birth_inf12 = (hfaz_inf_12 - hfaz_birth))

#make a table for 2 yrs old - 91 data
#find the difference between these

hfa_diff2 <- zscore_hfa %>% 
  select(basebrgy_basewman, sexchild, hfaz_inf_12, hfaz_91) %>%
  mutate(hfa_diff_inf12_91 = (hfaz_91 - hfaz_inf_12))

#make a table for 91 and 02 data
#find the difference between these

hfa_diff3 <- zscore_hfa %>% 
  select(basebrgy_basewman, sexchild, hfaz_91, hfaz_02) %>%
  mutate(hfa_diff_91_02 = (hfaz_02 - hfaz_91))

#visualize
hfa_diff1
hfa_diff2
hfa_diff3


```

#wfaz differences

```{r, cache=TRUE}

#make a table for birth and 2 yrs old data
#find the difference between these

wfa_diff1 <- zscore_wfa %>% 
  select(basebrgy_basewman, sexchild, wfaz_birth, wfaz_inf_12) %>%
  mutate(wfa_diff_birth_inf12 = (wfaz_inf_12 - wfaz_birth))

#make a table for 2 yrs old - 91 data
#find the difference between these

wfa_diff2 <- zscore_wfa %>% 
  select(basebrgy_basewman, sexchild, wfaz_inf_12, wfaz_91) %>%
  mutate(wfa_diff_inf12_91 = (wfaz_91 - wfaz_inf_12))


#visualize
wfa_diff1
wfa_diff2



```

#Join all of the data needed into one table
```{r, cache =TRUE}
#join difference tables
zscore_hfa_diffs <- left_join(hfa_diff1, hfa_diff2, by = c("basebrgy_basewman", "sexchild")) 
zscore_hfa_diffs <- left_join(zscore_hfa_diffs, hfa_diff3, by = c("basebrgy_basewman", "sexchild")) %>% 
  select(basebrgy_basewman, sexchild, hfaz_birth, hfaz_inf_12.x, hfaz_91.x, hfaz_02, hfa_diff_birth_inf12, hfa_diff_inf12_91, hfa_diff_91_02) %>% 
  rename(hfaz_inf_12 = hfaz_inf_12.x, hfaz_91 = hfaz_91.x )
  

zscore_hfa_diffs

zscore_wfa_diffs <- left_join(wfa_diff1, wfa_diff2, by = c("basebrgy_basewman", "sexchild", "wfaz_inf_12")) %>% 
  select(basebrgy_basewman, sexchild, wfaz_birth, wfaz_inf_12, wfaz_91, wfa_diff_birth_inf12, wfa_diff_inf12_91)
  
zscore_wfa_diffs

#join hfa diff and wfa diff
zscore_diffs <- left_join(zscore_hfa_diffs, zscore_wfa_diffs, by = c("basebrgy_basewman", "sexchild"))
zscore_diffs


```

```{r}
# join the growth datasets

growth_data <- left_join(growth83_86_data, growth91_data, by = c("basebrgy_basewman", "sexchild", "birthdate")) 
growth_data <- left_join(growth_data, growth02_data, by = c("basebrgy_basewman", "sexchild", "birthdate"))
growth_data <- left_join(growth_data, growth05_data, by = c("basebrgy_basewman", "sexchild", "birthdate"))



#join growth and difference datasets
growth_data_unfiltered <- left_join(growth_data, zscore_diffs, by = c("basebrgy_basewman", "sexchild")) %>% 
  separate(basebrgy_basewman, into = c("basebrgy", "basewman"), sep = "_")

growth_data_unfiltered

```

```{r}
#read in unc child ID data
unc_base_reprostat <-read_csv(here::here("Output/Data/CPR/unc_base_reprostat.csv"))
unc_base_reprostat

growth_data_unfiltered <- left_join(growth_data_unfiltered %>%
 as_character(basebrgy, basewman),
unc_base_reprostat %>%
 as_character(basebrgy, basewman),
by = c("basebrgy", "basewman"))

#organize variables into a better order
#rename variables so they're labeled with year

growth_data<- growth_data_unfiltered %>% 
  select(uncchdid, basebrgy, basewman, sexchild, sex, outcome, daybirth, mnthbrth, yearbirt, birthdate, dayintw,mothintw, yearintw, intwdate, age_days_birthweigh, weightak_kg, heightcm, daymes, mntham, yearms, date_inf_meas, age_days_infweigh, hght_12, wght_12, dyintrvw, mointr91, yrintr91, intwdate91, age91_days, age_mo_91, age91_years, hightndx, weghtndx, dayntrvw, montrvw, yrntrvw, intw_date02, age_days_02, age_years_02, age_cutoff, age_cutoff_days, height_02, weight_02, age, height_05, height_m_05, weight_05, bmi_05, hfaz_birth.x, hfaz_inf_12.x, hfaz_91.x, hfaz_02.x, hfa_diff_birth_inf12, hfa_diff_inf12_91, hfa_diff_91_02, wfaz_birth.x, wfaz_inf_12.x, wfaz_91.x, wfa_diff_birth_inf12, wfa_diff_inf12_91, reprostat, was_preg_no_na, trimester) %>% 
  rename(dayintw_birth = dayintw, mothintw_birth = mothintw, yearintw_birth = yearintw, intwdate_birth = intwdate, weightak_birth_kg = weightak_kg, heightcm_birth = heightcm, yearms_inf12 = yearms , mntham_inf12 = mntham, daymes_inf12 = daymes, dyintrvw91 = dyintrvw, weghtndx_91 = weghtndx, hightndx_91 = hightndx, age_cutoff_02 = age_cutoff, age_cutoff_02_days = age_cutoff_days, age_05 = age, dayntrvw_02 = dayntrvw, montrvw_02 = montrvw, yrntrvw_02 = yrntrvw, hfaz_birth = hfaz_birth.x, hfaz_inf_12 = hfaz_inf_12.x, hfaz_91 = hfaz_91.x, hfaz_02 = hfaz_02.x , wfaz_birth = wfaz_birth.x, wfaz_inf_12 = wfaz_inf_12.x, wfaz_91 = wfaz_91.x) 
  

growth_data

```


#read in epigenetic data
```{r}
clocks_data <- read_csv(here::here ("Data/Clocks/QC_Norm_LisaMcEwan_meth_DatMini3.output.csv"))

growth_clocks_data <- left_join(growth_data, clocks_data, by = c("uncchdid"))
growth_clocks_data

```
# modeling hfaz
```{r, cache=TRUE}
# build regression models for birth hfaz
# minimal just clock data and z scores?

grim_hbirth_min_f<-lm(AgeAccelGrim ~ hfaz_birth, subset(growth_clocks_data, sex == "2"))
grim_hbirth_min_f

grim_hbirth_min_m<-lm(AgeAccelGrim ~ hfaz_birth, subset(growth_clocks_data, sex == "1"))
grim_hbirth_min_m

pheno_hbirth_min_f <-update(grim_hbirth_min_f, AgeAccelPheno ~ .)
pheno_hbirth_min_f

pheno_hbirth_min_m <-update(grim_hbirth_min_m, AgeAccelPheno ~ .)
pheno_hbirth_min_m

han_hbirth_min_f <-update(grim_hbirth_min_f, EEAA ~ .)
han_hbirth_min_f

han_hbirth_min_m <-update(grim_hbirth_min_m, EEAA ~ .)
han_hbirth_min_m

horv_hbirth_min_f <-update(grim_hbirth_min_f, IEAA ~ .)
horv_hbirth_min_f

horv_hbirth_min_m <-update(grim_hbirth_min_m, IEAA ~ .)
horv_hbirth_min_m

#this is just examples of stuff I'm gonna need to do
mod1_full_f <-update(mod1_minimal, . ~ . + smoke + etc.)

lm (y ~ x + e, df %>% filter(female == 'f')

```
```{r, cache=TRUE}
#hfaz 2years old model
grim_hinf12_min_f<-lm(AgeAccelGrim ~ hfaz_inf_12, subset(growth_clocks_data, sex == "2"))
grim_hbirth_min_f

grim_hinf12_min_m<-lm(AgeAccelGrim ~ hfaz_inf_12 , subset(growth_clocks_data, sex == "1"))
grim_hinf12_min_m

pheno_hinf12_min_f <-update(grim_hinf12_min_f, AgeAccelPheno ~ .)
pheno_hinf12_min_f

pheno_hinf12_min_m <-update(grim_hinf12_min_m, AgeAccelPheno ~ .)
pheno_hinf12_min_m

han_hinf12_min_f <-update(grim_hinf12_min_f, EEAA ~ .)
han_hinf12_min_f

han_hinf12_min_m <-update(grim_hinf12_min_m, EEAA ~ .)
han_hbirth_min_m

horv_hinf12_min_f <-update(grim_hinf12_min_f, IEAA ~ .)
horv_hinf12_min_f

horv_hinf12_min_m <-update(grim_hinf12_min_m, IEAA ~ .)
horv_hinf12_min_m

```

```{r, cache=TRUE}
#hfaz_91 minimal models

grim_h91_min_f<-lm(AgeAccelGrim ~ hfaz_91, subset(growth_clocks_data, sex == "2"))
grim_h91_min_f

grim_h91_min_m<-lm(AgeAccelGrim ~ hfaz_91, subset(growth_clocks_data, sex == "1"))
grim_h91_min_m

pheno_h91_min_f <-update(grim_h91_min_f, AgeAccelPheno ~ .)
pheno_h91_min_f

pheno_h91_min_m <-update(grim_h91_min_m, AgeAccelPheno ~ .)
pheno_h91_min_m

han_h91_min_f <-update(grim_h91_min_f, EEAA ~ .)
han_h91_min_f

han_h91_min_m <-update(grim_h91_min_m, EEAA ~ .)
han_h91_min_m

horv_h91_min_f <-update(grim_h91_min_f, IEAA ~ .)
horv_h91_min_f

horv_h91_min_m <-update(grim_h91_min_m, IEAA ~ .)
horv_h91_min_m

```

```{r, cache=TRUE}
#hfaz 02 models: minimal

grim_h02_min_f<-lm(AgeAccelGrim ~ hfaz_02, subset(growth_clocks_data, sex == "2"))
grim_h02_min_f

grim_h02_min_m<-lm(AgeAccelGrim ~ hfaz_02, subset(growth_clocks_data, sex == "1"))
grim_h02_min_m

pheno_h02_min_f <-update(grim_h02_min_f, AgeAccelPheno ~ .)
pheno_h02_min_f

pheno_h02_min_m <-update(grim_h02_min_m, AgeAccelPheno ~ .)
pheno_h02_min_m

han_h02_min_f <-update(grim_h02_min_f, EEAA ~ .)
han_h02_min_f

han_h02_min_m <-update(grim_h02_min_m, EEAA ~ .)
han_h02_min_m

horv_h02_min_f <-update(grim_h02_min_f, IEAA ~ .)
horv_h02_min_f

horv_h02_min_m <-update(grim_h02_min_m, IEAA ~ .)
horv_h02_min_m

```
#modeling wfaz

```{r, cache=TRUE}
#wfa birth minimal models
grim_wbirth_min_f<-lm(AgeAccelGrim ~ wfaz_birth, subset(growth_clocks_data, sex == "2"))
grim_wbirth_min_f

grim_wbirth_min_m<-lm(AgeAccelGrim ~ wfaz_birth, subset(growth_clocks_data, sex == "1"))
grim_wbirth_min_m

pheno_wbirth_min_f <-update(grim_wbirth_min_f, AgeAccelPheno ~ .)
pheno_wbirth_min_f

pheno_wbirth_min_m <-update(grim_wbirth_min_m, AgeAccelPheno ~ .)
pheno_wbirth_min_m

han_wbirth_min_f <-update(grim_wbirth_min_f, EEAA ~ .)
han_wbirth_min_f

han_wbirth_min_m <-update(grim_wbirth_min_m, EEAA ~ .)
han_wbirth_min_m

horv_wbirth_min_f <-update(grim_wbirth_min_f, IEAA ~ .)
horv_wbirth_min_f

horv_wbirth_min_m <-update(grim_wbirth_min_m, IEAA ~ .)
horv_wbirth_min_m


```

```{r, cache=TRUE}
#wfaz inf12 minimal models
grim_winf12_min_f<-lm(AgeAccelGrim ~ hfaz_inf_12, subset(growth_clocks_data, sex == "2"))
grim_winf12_min_f

grim_winf12_min_m<-lm(AgeAccelGrim ~ wfaz_inf_12, subset(growth_clocks_data, sex == "1"))
grim_winf12_min_m

pheno_winf12_min_f <-update(grim_winf12_min_f, AgeAccelPheno ~ .)
pheno_winf12_min_f

pheno_winf12_min_m <-update(grim_winf12_min_m, AgeAccelPheno ~ .)
pheno_winf12_min_m

han_winf12_min_f <-update(grim_winf12_min_f, EEAA ~ .)
han_winf12_min_f

han_winf12_min_m <-update(grim_winf12_min_m, EEAA ~ .)
han_winf12_min_m

horv_winf12_min_f <-update(grim_winf12_min_f, IEAA ~ .)
horv_winf12_min_f

horv_winf12_min_m <-update(grim_winf12_min_m, IEAA ~ .)
horv_winf12_min_m

```

```{r, cache=TRUE}
#wfaz 91 minimal models
grim_w91_min_f<-lm(AgeAccelGrim ~ hfaz_91, subset(growth_clocks_data, sex == "2"))
grim_w91_min_f

grim_w91_min_m<-lm(AgeAccelGrim ~ wfaz_91, subset(growth_clocks_data, sex == "1"))
grim_w91_min_m

pheno_w91_min_f <-update(grim_w91_min_f, AgeAccelPheno ~ .)
pheno_w91_min_f

pheno_w91_min_m <-update(grim_w91_min_m, AgeAccelPheno ~ .)
pheno_w91_min_m

han_w91_min_f <-update(grim_w91_min_f, EEAA ~ .)
han_w91_min_f

han_w91_min_m <-update(grim_w91_min_m, EEAA ~ .)
han_w91_min_m

horv_w91_min_f <-update(grim_w91_min_f, IEAA ~ .)
horv_w91_min_f

horv_w91_min_m <-update(grim_w91_min_m, IEAA ~ .)
horv_w91_min_m

```

